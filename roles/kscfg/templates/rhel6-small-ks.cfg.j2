# Kickstart file automatically generated by anaconda.

#version=DEVEL
install
cdrom
lang ja_JP.UTF-8
keyboard jp106
network --onboot yes --device {{item.kscfg_netdev}} --bootproto static --ip {{item.kscfg_ip}} --netmask {{item.kscfg_netmask}} --gateway {{item.kscfg_gateway}} --noipv6 {% if item.kscfg_nameserver is defined %}--nameserver {{item.kscfg_nameserver}} {% endif %}--hostname {{item.kscfg_hostname}}
rootpw --iscrypted {{item.kscfg_rootpw}}
firewall --service=ssh
authconfig --enableshadow --passalgo=sha512
selinux --enforcing
timezone Asia/Tokyo
bootloader --location={% if item.kscfg_uefi_firmware %}partition{% else %}mbr{% endif %} --driveorder={{item.kscfg_hdddev}} --append="crashkernel=auto"
# The following is the partition information you requested
# Note that any partitions you deleted are not expressed
# here so unless you clear all partitions first, this is
# not guaranteed to work
#clearpart --none
zerombr
clearpart --all --initlabel --drives={{item.kscfg_hdddev}}

#part /boot/efi --fstype=efi --size=256
#part /boot --fstype=ext4 --size=512
#part / --fstype=ext4 --grow --size=1
#part /dump --fstype=ext4 --size=4096
#part swap -size=4096
{% if item.kscfg_uefi_firmware %}
part /boot/efi --fstype=efi --size=256
{% endif %}
part /boot --fstype=ext4 --ondisk={{item.kscfg_hdddev}} {% if not item.kscfg_uefi_firmware %}--asprimary{% endif %} --size=512
part / --fstype=ext4 --ondisk={{item.kscfg_hdddev}} --grow {% if not item.kscfg_uefi_firmware %}--asprimary{% endif %} --size=1
part swap --fstype=swap --ondisk={{item.kscfg_hdddev}} {% if not item.kscfg_uefi_firmware %}--asprimary{% endif %} --size={{item.kscfg_memsize | int // 2}}
{% if item.kscfg_kdump_part %}
part /dump --fstype=ext4 --ondisk={{item.kscfg_hdddev}} {% if not item.kscfg_uefi_firmware %}--asprimary{% endif %} --size={{(item.kscfg_memsize | int * 1.1) | int}}
{% endif %}

poweroff

%packages
@core
@japanese-support
@server-policy
{% for pkg in item.kscfg_pkg_addlist %}
{{pkg}}
{% endfor %}
%end
